{% extends "base.html" %}

{% block title %}Gastos Pendientes de Aprobación{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Gastos Pendientes de Aprobación</h2>

    {% if expenses %}
        <div class="table-responsive mt-3">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Empleado</th>
                        <th>Fecha</th>
                        <th>Categoría</th>
                        <th>Monto</th>
                        <th>Cliente</th>
                        <th>Razón</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for expense in expenses %}
                    <tr>
                        <td>{{ expense.id }}</td>
                        <td>{{ expense.user.full_name }}</td>
                        <td>{{ expense.expense_date.strftime('%d/%m/%Y') }}</td>
                        <td>{{ expense.category }}</td>
                        <td>${{ "{:,.0f}".format(expense.amount) }}</td>
                        <td>{{ expense.client.name if expense.client else '-' }}</td>
                        <td>{{ expense.reason[:50] }}{% if expense.reason|length > 50 %}...{% endif %}</td>
                        <td>
                            <a href="{{ url_for('approvals.detail', expense_id=expense.id) }}"
                               class="btn btn-sm btn-info">Ver</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="alert alert-info mt-3">
            No hay gastos pendientes de aprobación.
        </div>
    {% endif %}

    {% if pagination %}
    <div class="mt-4">
        {% include '_pagination.html' %}
    </div>
    {% endif %}

    <div class="mt-3">
        <a href="{{ url_for('approvals.all_expenses') }}" class="btn btn-secondary">Ver Todos los Gastos</a>
        <a href="{{ url_for('approvals.history') }}" class="btn btn-secondary">Mi Historial de Aprobaciones</a>
    </div>
</div>
{% endblock %}
